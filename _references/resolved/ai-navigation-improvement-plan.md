# AI ナビゲーション改善計画

<br />

## 1. 現状の問題点

現在のシステムプロンプトでは、以下の矛盾した情報が含まれています。

### 問題のある部分

1. **セルタイプの説明（92-101行目）**で、ロボットが認識できる情報を明確に定義：
   - `start`：位置は認識できる
   - `end`：位置は認識できない ← 重要
   - `trap`：位置は認識できない ← 重要
   - `object`：位置は認識できる
   - `normal`：位置は認識できる

2. **しかし、マップレイアウトセクション（110-124行目）**で、完全なマップレイアウトを提供：
   ```
   Y=0（1行目）: [s,n,n,n,n,n]
   Y=1（2行目）: [n,n,t,n,n,n]  ← トラップの位置が見える
   Y=2（3行目）: [n,n,o,n,n,n]
   Y=3（4行目）: [n,n,n,t,n,n]  ← トラップの位置が見える
   Y=4（5行目）: [n,n,n,n,n,n]
   Y=5（6行目）: [o,n,n,n,n,e]  ← ゴールの位置が見える
   ```

3. **マップの記号定義（133-143行目）**で、すべての記号の意味を説明

これにより、AI は「トラップを避けて、お宝までの道筋を進めてください」という指示だけで、マップ全体を把握して最適なルートを計算できてしまいます。

<br />

## 2. 改善策

### 方針 1: マップレイアウトの選択的開示

マップレイアウトを提供する際、ロボットが認識できない情報は隠蔽する：

- `trap` (t) と `end` (e) のセルは、`?`（不明）として表示
- `start`、`object`、`normal` のみ正確な記号で表示

### 方針 2: ユーザー指示への依存強化

ロボットが自律的に判断できないことを明確にし、ユーザーの具体的な指示に完全に依存するように強調する。

### 方針 3: 記号の意味の部分的開示

記号定義セクションで、認識できない記号については「認識不可」と明記する。

<br />

## 3. 実装計画

1. `generateMapLayoutSection` 関数を修正：
   - トラップとゴールの位置をマスクする
   - ロボットが認識可能な要素のみを表示

2. `generateMapSymbolSection` 関数を修正：
   - 各記号について、ロボットが認識可能かどうかを明記

3. 新しいセクションを追加：
   - ロボットの制限事項を明確に説明
   - ユーザーの指示なしには目的地へ到達できないことを強調

<br />

## 4. 期待される効果

- 「トラップを避けて、お宝までの道筋を進めてください」のような曖昧な指示では、ロボットは動けなくなる
- ユーザーは具体的な移動指示（「下に4マス」「右に1マス」など）を提供する必要がある
- ゲームの本来の目的である「プレイヤーがAIに具体的な指示を与える」体験が実現される