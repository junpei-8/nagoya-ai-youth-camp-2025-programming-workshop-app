# システムプロンプト改修仕様書：直接的な数値指示の廃止

## 1. 目的

AI が「Nマス進む」といった直接的・絶対的な数値による移動指示を解釈できないようにシステムプロンプトを改修する。
これにより、AI は「次の角まで」「オブジェクトまで」といった、より曖昧で文脈に依存した指示を、自身が認識できる情報（オブジェクトの位置など）と照らし合わせて解釈する能力を養うことを目的とする。

<br />

## 2. 改修方針

既存のプロンプトから、数値と移動回数を直接関連付ける記述を削除・修正し、数値が移動回数ではないことを明確に指示する。

<br />

## 3. 具体的な変更点

### 3.1. 「数値の理解と移動の実行」セクションの削除

以下のセクションは、数値指示を移動回数として解釈することを助長するため、完全に削除する。

<br />

#### 削除対象セクション

```markdown
## 数値の理解と移動の実行
「Nマス進む」という指示を受けた場合：
- 「4マス進む」→ その方向に4回移動（例：下なら"WWWW"）
- 「1マス進む」→ その方向に1回移動（例：右なら"D"）
- 数値は必ず移動回数として解釈してください

具体例：
- 「下に4マス」→ `WWWW`
- 「右に1マス」→ `D`
- 「右に4マス」→ `DDDD`
```

<br />

### 3.2. 「段階的な指示の解釈」セクションの修正

数値指示に関する項目と具体例を削除し、ステップごとの指示に従うことの重要性を強調する内容に修正する。

<br />

#### 変更前

```markdown
## 段階的な指示の解釈
番号付きの指示がある場合：
1. 各ステップは前のステップの終了位置から開始
2. 指示の順序は重要 - 変更してはいけません
3. 「進めます」「進んでください」などの表現の違いは無視し、移動指示として統一的に解釈
4. 各ステップの数値指示を正確に実行する
5. 指示されていない追加の移動は絶対に行わない

重要：ユーザーの指示通りの移動のみを出力してください。
例：
指示「1. 下に4マス 2. 右に1マス 3. 下に1マス 4. 右に4マス」の場合：
正しい出力: `SSSSDS DDDD`
間違った出力: `SSSSDS DSDDDD` （余計な下移動を追加）
```

<br />

#### 変更後

```markdown
## 段階的な指示の解釈
番号付きや連続した指示がある場合、それらは順番に実行されるべき一連の命令です。

1. 各ステップは、前のステップが完了した位置から開始されます。
2. 指示の順序は極めて重要です。障害物を回避するために慎重に設計されているため、絶対に変更しないでください。
3. 指示されていない追加の移動は絶対に行わないでください。

**重要**：ユーザーの指示は、常に一連のステップとして解釈し、その順番通りに移動計画を立ててください。
```

<br />

### 3.3. 「限定的な情報での指示解釈」セクションの強化

セクション名を「指示の解釈方法」に変更し、数値による指示がないことを明確にし、代わりにどのような指示が与えられるかを説明する。

<br />

#### 変更後

```markdown
## 指示の解釈方法
あなたのタスクは、与えられた指示を、自身が認識できるマップ情報（オブジェクトの位置など）と照らし合わせて解釈し、具体的な移動経路に変換することです。

- **指示の形式**: 指示は「Nマス進む」のような**具体的な数値では与えられません**。「下に見えるオブジェクトまで進む」「壁に突き当たるまで右へ」といった、目的地や条件を示す形になります。
- **解釈の例**:
    - 「下のオブジェクトまで」→ 現在位置から下方向にある、認識可能な最も近いオブジェクトを特定し、そこまでの移動経路を生成します。
    - 「右に曲がって次の角まで」→ 現在の位置から右に90度向きを変え、壁（通行不可能なセル）にぶつかる手前まで直進する経路を生成します。

**注意**: 指示の順序には意味があります。一見遠回りに見える経路も、あなたには見えない障害物を避けている可能性があります。
```

<br />

### 3.4. 「指示解釈の重要な原則」セクションの修正

数値に関する新たなルールを追加する。

<br />

#### 変更後に追加する項目

```
5. 指示に含まれる数値は、移動回数ではありません。オブジェクトの識別番号（例：「1番のオブジェクトへ」）など、別の意味を持つ可能性があります。数値を移動回数として解釈してはいけません。
```

<br />

### 3.5. 「最終的な出力形式」セクションの修正

数値ベースの例を削除し、出力形式のルール説明に集中させる。

<br />

#### 変更後の「正しい出力例」

```markdown
### 正しい出力例
あなたの応答は、移動を示す文字（W, A, S, Dなど）を連続させた文字列でなければなりません。

- `WWWWSDDDDS`
- `DDWWWAAW`
```
